f# Only run for interactive shells
[[ -o interactive ]] || return

###############################################################################
# Environment & Theme Settings
###############################################################################
# Local bin path
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/bin:$PATH"

# Set the oh-my-posh theme
export OMPTHEME=json.custom

# Initialize oh‑my‑posh for zsh (using your custom theme config)
eval "$(oh-my-posh init zsh --config $HOME/.oh-my-posh/themes/$OMPTHEME.omp.json)"

###############################################################################
# History & Completion Settings
###############################################################################
# Set history file and sizes
HISTFILE=~/.zsh_history
HISTSIZE=3000
SAVEHIST=5000

# Append history rather than overwriting it, and share history among sessions
setopt append_history inc_append_history share_history

# Enable case-insensitive completion
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'

# Ctrl-R fuzzy search through history (need fzf installed)
bindkey '^R' fzf-history-widget
autoload -Uz fzf-history-widget

###############################################################################
# Aliases, Functions, and Extras
###############################################################################
# Source your custom aliases and functions from .bash_aliases (they’re mostly portable)
if [ -f ~/.zsh_aliases ]; then
  source ~/.zsh_aliases
fi

# Source scriptlets
if [ -f ~/.zsh_scriptlets ]; then
  source ~/.zsh_scriptlets
fi

###############################################################################
# Oh My Zsh Framework
###############################################################################
# Set up oh‑my‑zsh (disable its theme if you prefer oh‑my‑posh for the prompt)
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME=""  # Leave empty to avoid theme conflicts with oh-my-posh
plugins=(git)
source $ZSH/oh-my-zsh.sh

# Initialize zoxide for zsh
eval "$(zoxide init zsh --cmd cd)"

# Re-Init OMP Theme
omp-theme ${OMPTHEME} > /dev/null

###############################################################################
# Pyenv Setup
###############################################################################
export PYENV_ROOT="$HOME/.pyenv"
[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init - bash)"

# Load pyenv-virtualenv
eval "$(pyenv virtualenv-init -)"
